webpackJsonp([11],{294:function(t,a,e){e(295),e(296),e(297),e(298),e(299),e(300),e(301),t.exports=e(302)},295:function(t,a){!function(){"use strict";angular.module("app").factory("TicketFactory",["$http",function(t){return{cadastrarTicket:function(a){return t.post("/ticket",a)},pesquisaSubcategoria:function(a){return t.post("/ticket/pesquisaSubcategoria",a)},atualizarTicket:function(a){return t.put("/ticket/"+a.id,a)},pesquisarTicket:function(a){return t.post("/ticket/search",a)},interacaoTicket:function(a){return t.post("/ticket/interacao",a)},getStatus:function(a){return t.post("/ticket/status/"+a)},getSolicitante:function(a){return t.post("/ticket/solicitante/"+a)},getPrioridade:function(a){return t.post("/ticket/prioridade/"+a)},getCategoria:function(a){return t.post("/ticket/categoria/"+a)},getCamposAdicionais:function(a){return t.post("/ticket/campos_adicionais/"+a)},pesquisarTicketProprio:function(a){return t.post("/ticket/searchProprio",a)},getImagemTicket:function(a){return t.get("/ticket/imagem/"+a)},getImagemTicketDados:function(a){return t.get("/ticket/imagemDados/"+a)},destroyImagemTicket:function(a){return t.delete("/ticket/imagem/"+a)},getAcaoMacro:function(a,e){return t.post("/ticket/acaoMacro/"+a,e)},executaMacro:function(a){return t.post("/ticket/executaMacro",a)}}}])}()},296:function(t,a){!function(){"use strict";angular.module("app").controller("cadastrarTicketCtrl",["$scope","$uibModal","$window","TicketFactory","$sce","serviceTicketCtrl",function(t,a,e,o,i,r){var n=_departamentos;function c(t,a){return(t+"").replace(/([^>\r\n]?)(\r\n|\n\r|\r|\n)/g,"$1"+(a||void 0===a?"<br />":"<br>")+"$2")}t.mostraSolicitante=function(){t.ticket.departamento&&o.getSolicitante(t.ticket.departamento.id).then(function(a){var e=a.data.filter(function(t){return"selected"==t.selected});t.solicitantes=a.data;var o=t.solicitantes.map(function(t){return t.id}).indexOf(e[0].id);t.ticket.solicitante=t.solicitantes[o]},function(a){t.solicitantes=null}).finally(function(){})},t.mostraPrioridade=function(){t.ticket.departamento&&o.getPrioridade(t.ticket.departamento.id).then(function(a){var e=a.data.filter(function(t){return"selected"==t.selected});t.prioridades=a.data;var o=t.prioridades.map(function(t){return t.id}).indexOf(e[0].id);t.ticket.prioridade=t.prioridades[o]},function(a){t.prioridades=null}).finally(function(){})},t.verificaDescricaoPrioridade=function(a){var e=t.prioridades.filter(function(t){return t.id==a});null!=e[0].descricao&&""!=e[0].descricao&&t.dicaModalPrioridades(t,e[0].descricao)},t.mostraCategoria=function(){t.ticket.departamento&&o.getCategoria(t.ticket.departamento.id).then(function(a){t.categorias=a.data},function(a){t.categorias=null}).finally(function(){})},t.renderHtml=function(t){return i.trustAsHtml(t)},t.mostraCamposAdicionais=function(){t.ticket.departamento&&o.getCamposAdicionais(t.ticket.departamento.id).then(function(a){t.campos_adicionais=a.data},function(a){t.campos_adicionais=null}).finally(function(){})},t.mostrarSubcategoria=function(a){void 0!=a?o.pesquisaSubcategoria(a).then(function(a){t.dicaModal=a.data.categoriaDica[0].dicas,t.subcategoria=a.data.subcategoria,""!=t.dicaModal&&t.abreModalDica(t.dicaModal)},function(a){t.errors=a.data}).finally(function(){}):t.subcategoria=""},t.dicaSubcategoria=function(a){void 0!=a&&""!=a.dicas&&t.abreModalDica(a.dicas)},t.alterarDepartamento=function(a){(t.ticket.solicitante||t.ticket.prioridade||t.ticket.assunto||t.ticket.categoria||t.ticket.descricao)&&void 0!=a?r.modal(a,t):(t.mostraSolicitante(),t.mostraPrioridade(),t.mostraCategoria(),t.mostraCamposAdicionais())},t.cadastrar=function(a){t.form.$valid=!1,t.success=!1,t.errors=!1;var i=angular.element(document.getElementsByName("campo_adicional"));a.campo_adicional=[],angular.forEach(i,function(t){var e={id:t.attributes["data-campo-id"].value,value:t.value};a.campo_adicional.push(e)}),o.cadastrarTicket(a).then(function(a){t.success=a.data.mensagem,t.url=""+a.data.id,e.location.href=a.data.id},function(a){t.errors=a.data}).finally(function(){})},t.abreModalDica=function(t){var o=a.open({animation:!0,ariaLabelledBy:"modal-title-bottom",ariaDescribedBy:"modal-body-bottom",size:"md",templateUrl:"todasDicaModal.html",controller:function(a){a.dicaModal=c(t),a.continuarTicket=function(){o.close()},a.pesquisarTicket=function(){e.location.href="/ticket"}}})},t.dicaModalPrioridades=function(t,e){var o=a.open({animation:!0,ariaLabelledBy:"modal-title-bottom",ariaDescribedBy:"modal-body-bottom",size:"md",templateUrl:"dicaModalPrioridades.html",scope:t,controller:function(t){t.dicaModal=c(e),t.continuarTicket=function(){o.close()},t.checarMenorPrioridade=function(){t.mostraPrioridade(),o.close()}}})},t.success="",t.subcategoria="",t.departamentos=n,t.oldValue=""}])}()},297:function(t,a){!function(){"use strict";angular.module("app").controller("visualizarTicketCtrl",["$scope","$uibModal","$window","TicketFactory","Upload","$location","serviceTicketCtrl","$q","$filter",function(t,a,e,o,i,r,n,c,d){var s,u;t.interacao=function(){var t=l();t.interno=!1,p(t)},t.notaInterna=function(){var t=l();t.interno=!0,p(t)};var l=function(){t.form.$valid=!1;var a={};return a.id=s,a.mensagem=t.ticket.mensagem.toUpperCase(),a},p=function(a){t.success=!1,t.errors=!1,t.form.$valid=!1,o.interacaoTicket(a).then(function(t){1==t.data.status&&e.location.reload()},function(a){t.errors=a.data}).finally(function(){t.form.$valid=!1})};t.escondeErro=function(){t.errors=""},t.keyPressDescricaoImagem=function(a){13===a.which&&(t.confirmarImagem(),a.preventDefault())},t.confirmarImagem=function(){if(t.errors={},t.formImagem.$valid=!1,t.imagem.file&&t.imagem.texto)i.upload({url:"/ticket/imagem",data:{imagem:t.imagem.file,ticket_id:t.imagem.ticket_id,texto:t.imagem.texto},headers:{"Content-Type":"multipart/form-data"}}).then(function(a){t.success=a.data.mensagem,t.imagem.file=!1,t.formImagem.$valid=!0,t.imagem.texto="",setTimeout(function(){e.location.reload()},2e3)},function(a){t.errors=a.data});else if(t.imagem.file){a={errors:{0:"Campo descrição é obrigatório"}};t.errors=a}else{var a={errors:{0:"Por favor selecione uma imagem"}};t.errors=a}},t.verificaTab=function(){var a=e.location.href.split("#!#");"interacao"==a[1]?t.tab=1:"imagem"==a[1]?t.tab=2:"historico"==a[1]?t.tab=3:"acao"==a[1]?(t.tab=4,t.campos_macro=""):t.tab=1},t.showModal=function(a){t.carregandoModalImagemDados=!0;var e=o.getImagemTicketDados(a).then(function(t){return t.data});c.all([e]).then(function(a){n.modalImagem(a),t.carregandoModalImagemDados=!1})},t.acaoMacro=function(a){t.success=!1,t.errors=!1,u=a;var e={ticket_id:s};o.getAcaoMacro(a,e).then(function(a){if(1==a.data.status){if(t.tab=4,t.campos_macro=a.data.acao,t.acao_responsavel=a.data.responsavel,t.acao.responsavel=t.acao_responsavel[f(a.data.responsavel,t.acao_responsavel)],t.acao_status=a.data.ticket_status,""!=t.acao_status){var e=f(a.data.ticket_status,t.acao_status);t.acao.status=0==e?t.acao_status[e].id:t.acao_status[e].id.toString()}t.acao.dt_previsao=a.data.dt_previsao,t.acao_solicitante=a.data.solicitantes,t.acao.solicitante=t.acao_solicitante[f(a.data.solicitantes,t.acao_solicitante)],t.acao_categoria=a.data.categoria,t.acao.categoria=t.acao_categoria[f(a.data.categoria,t.acao_categoria)],t.acao_subcategoria=a.data.subcategoria,t.acao.subcategoria=t.acao_subcategoria[f(a.data.subcategoria,t.acao_subcategoria)],t.acao.assunto=a.data.assunto,t.acao_prioridade=a.data.prioridade,t.acao.prioridade=t.acao_prioridade[f(a.data.prioridade,t.acao_prioridade)],t.acao.dt_notificacao=a.data.dt_notificacao,1==t.campos_macro.interacao&&1==t.campos_macro.nota_interna&&(t.acao.interacao=!1),1==t.campos_macro.interacao&&0==t.campos_macro.nota_interna&&(t.acao.interacao=!1),0==t.campos_macro.interacao&&1==t.campos_macro.nota_interna&&(t.acao.interacao=!0)}},function(a){t.tab=4,t.errors=a.data})},t.mostrarSubcategoria=function(a){void 0!=a?o.pesquisaSubcategoria(a).then(function(a){t.acao_subcategoria=a.data.subcategoria,t.acao.subcategoria=t.acao_subcategoria[0]},function(a){t.errors=a.data}):t.acao.subcategoria=""},t.executaMacro=function(){t.success=!1,t.errors=!1,t.formMacro.$valid=!1,t.acao.ticket_id=s,t.acao.acao_id=u,t.campos_macro.campos.indexOf("campos_adicionais")>0&&m(),t.campos_macro.campos.indexOf("avaliacao")>0&&(t.acao.avaliacao=t.ratings[0].current);var a={acoes_macro:t.acao};o.executaMacro(a).then(function(a){t.success=a.data.mensagem,t.iconeCarregando=!0,1==a.data.status&&setTimeout(function(){var t=e.location.href.split("#!#");e.location.href=t[0]+"#interacao",e.location.reload()},2e3)},function(a){t.errors=a.data})};var f=function(t,a){var e=0;return angular.forEach(t,function(t){"selected"==t.selected&&(e=a.indexOf(t))}),e},m=function(a){var e=angular.element(document.getElementsByName("campo_adicional"));t.acao.campo_adicional=[],angular.forEach(e,function(a){var e={id:a.attributes["data-campo-id"].value,value:a.value.toUpperCase()};t.acao.campo_adicional.push(e)})};s=_ticket_id,u="",t.acao={responsavel:"",solicitante:"",categoria:"",subcategoria:""},t.rating=0,t.ratings=[{current:1,max:5}],t.verificaTab(),t.date_min=d("date")(new Date,"dd-MM-yyyy HH:mm")}])}()},298:function(t,a){!function(){"use strict";angular.module("app").controller("listarTicketCtrl",["$scope","$rootScope","$http","TicketFactory","$cookies","$filter","$location",function(t,a,e,o,i,r,n){_filtro;var c=_departamentos,d=_usuarios,s=function(){return void 0!==i.get("ticket_codigo")||void 0!==i.get("ticket_assunto")||void 0!==i.get("ticket_ticket_de")||void 0!==i.get("ticket_ticket_ate")||void 0!==i.get("ticket_aberto")||void 0!==i.get("ticket_usuario_responsavel")||void 0!==i.get("ticket_usuario_solicitante")||void 0!==i.get("ticket_categoria")||void 0!==i.get("ticket_statuse")||void 0!==i.get("ticket_prioridade")};t.defineFiltro=function(){var a=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";a!=t.filter.coluna&&(t.filter.coluna=a),t.filter.ordem="asc"==t.filter.ordem?"desc":"asc",t.pesquisaTicket(t.filter)},t.onGetPage=function(a){a>=1&&a<=t.paginacao.totalDePaginas&&(t.filter.to=a,t.pesquisaTicket(t.filter))},t.pesquisaTicket=function(e){t.disableButton=!0,t.success=!1,t.errors=!1,t.carregando=!0,o.pesquisarTicket(t.filter).then(function(o){t.lista=o.data.ticket.data,t.usuario_logado=a.auth.id;var r=1==o.data.ticket.current_page?1:o.data.ticket.total<e.limite?(o.data.ticket.current_page-1)*e.limite+o.data.ticket.total:(o.data.ticket.current_page-1)*e.limite+1,n=0==e.limite?o.data.ticket.total:o.data.ticket.total<e.limite?o.data.ticket.total:o.data.ticket.current_page*e.limite,c=o.data.ticket.total%e.limite==0?o.data.ticket.total/e.limite:Math.floor(o.data.ticket.total/e.limite)+1;i.put("ticket_assunto",o.data.assunto),i.put("ticket_codigo",o.data.codigo),i.put("ticket_departamento",o.data.departamento),i.put("ticket_aberto",o.data.aberto),i.put("ticket_usuario_responsavel",o.data.usuario_responsavel),i.put("ticket_usuario_solicitante",o.data.usuario_solicitante),i.put("ticket_pagina",e.pagina),i.put("ticket_ticket_de",e.de),i.put("ticket_ticket_ate",e.ate),t.paginacao={total:o.data.ticket.total,pagina:o.data.ticket.current_page,de:r,ate:n,limite:e.limite,totalDePaginas:c}},function(a){t.errors=a.data,401==a.status&&(t.reload=function(){location.href="/login"},t.reload())}).finally(function(){t.disableButton=!1,t.carregando=!1})},t.abrePesquisa=function(){1==t.filtro?(t.filtro=!1,t.filtrando=!1):(t.filtro=!0,t.filtrando=!0)},t.limpaPesquisa=function(){t.filter.de="",t.filter.ate="",t.filter.aberto="true",t.filter.assunto="",t.filter.codigo="",t.filter.usuario_responsavel=d[0],t.filter.usuario_solicitante=d[0],t.filter.departamento=c[0],t.filter.categoria=0,t.filter.statuse=0,t.filter.prioridade=0,t.pesquisaTicket(t.filter)},t.selecionaDepartamento=function(){0!=t.filter.departamento.id&&(o.getPrioridade(t.filter.departamento.id).then(function(a){t.prioridades=a.data},function(a){t.errors=a.data}).finally(function(){}),o.getStatus(t.filter.departamento.id).then(function(a){t.statuses=a.data},function(a){t.errors=a.data}).finally(function(){}),o.getCategoria(t.filter.departamento.id).then(function(a){t.categorias=a.data},function(a){t.errors=a.data}).finally(function(){})),0==t.filter.departamento.id&&(t.categorias="",t.statuses="",t.prioridades="")},t.verificaCookiesDepartamento=function(){t.filter.departamento=t.departamentos[u("ticket_departamento",t.departamentos)]},t.verificaCookiesStatuse=function(){},t.verificaCookiesCategoria=function(){},t.verificaCookiesPrioridade=function(){},t.verificaCookiesSolicitante=function(){t.filter.usuario_solicitante=t.usuarios[u("ticket_usuario_solicitante",t.usuarios)]},t.verificaCookiesResponsavel=function(){t.filter.usuario_responsavel=t.usuarios[u("ticket_usuario_responsavel",t.usuarios)]};var u=function(t,a){if(isNaN(parseInt(i.get(t)))||"0"==i.get(t))return 0;var e=0;return angular.forEach(a,function(o){o.id==i.get(t)&&(e=a.indexOf(o))}),e};t.csv=function(){document.exportar.action="/ticket/download/csv",document.exportar.submit()},t.xlsx=function(){document.exportar.action="/ticket/download/xlsx",document.exportar.submit()};c.unshift({id:"",nome:""}),t.departamentos=c,d.unshift({id:"",nome:""}),t.usuarios=d,t.filter={coluna:"status_ordem",ordem:"asc",pagina:1,limite:50,reverso:!0,aberto:!0,departamento:0,usuario_responsavel:0,usuario_solicitante:0,categoria:0,statuse:0,prioridade:0,assunto:"",codigo:""},t.paginacao={de:0,ate:0,total:0,pagina:0},0==s()?(t.filter.de="",t.filter.ate="",t.filter.aberto="true",t.filter.codigo="",t.filter.assunto="",t.filter.departamento=void 0,t.filter.usuario_responsavel=void 0,t.filter.usuario_solicitante=void 0,t.filter.categoria=void 0,t.filter.statuse=void 0,t.filter.prioridade=void 0):(t.filtro=""!=i.get("ticket_codigo")||""!=i.get("ticket_assunto")||!isNaN(parseInt(i.get("ticket_usuario_responsavel")))&&"0"!=i.get("ticket_usuario_responsavel")||"true"!=i.get("ticket_aberto")||!isNaN(parseInt(i.get("ticket_ticket_de")))&&""!=i.get("ticket_ticket_de")||!isNaN(parseInt(i.get("ticket_ticket_ate")))&&""!=i.get("ticket_ticket_ate")||!isNaN(parseInt(i.get("ticket_usuario_solicitante")))&&"0"!=i.get("ticket_usuario_solicitante")||!isNaN(parseInt(i.get("ticket_departamento")))&&"0"!=i.get("ticket_departamento"),t.filter.de=i.get("ticket_ticket_de"),t.filter.ate=i.get("ticket_ticket_ate"),t.filter.codigo=i.get("ticket_codigo"),t.filter.assunto=i.get("ticket_assunto"),t.filter.usuario_responsavel=i.get("ticket_usuario_responsavel"),t.filter.usuario_solicitante=i.get("ticket_usuario_solicitante"),t.filter.departamento=i.get("ticket_departamento"),t.filter.aberto=i.get("ticket_aberto"),t.filter.categoria=i.get("ticket_categoria"),t.filter.statuse=i.get("ticket_statuse"),t.filter.prioridade=i.get("ticket_prioridade")),t.pesquisaTicket(t.filter)}]),angular.module("app").config(["$qProvider",function(t){t.errorOnUnhandledRejections(!1)}])}()},299:function(t,a){!function(){"use strict";angular.module("app").controller("editarTicketCtrl",["$scope","$filter","TicketFactory",function(t,a,e){var o=_subcategoria,i=_ticket_dt_previsao;!function(){t.ticket={},t.subcategoria=o,t.subcategoria.unshift({id:"",nome:"",dicas:"",selected:""});var e=0;angular.forEach(t.subcategoria,function(a){""!=a.selected&&(e=t.subcategoria.indexOf(a))}),t.ticket.subcategoria=t.subcategoria[e],""!=i&&(t.ticket.dt_previsao=a("date")(i,"dd/MM/yyyy"))}(),t.customChange=function(a){var o=angular.element(document.querySelector("#categoria"))[0].value;void 0!=o?e.pesquisaSubcategoria(o).then(function(a){t.subcategoria=a.data.subcategoria,t.subcategoria.unshift({id:"",nome:"",dicas:""}),t.ticket.subcategoria=t.subcategoria[0]},function(a){t.errors=a.data}).finally(function(){t.form.$valid=!0}):t.subcategoria=""},t.atualizar=function(a){a.status=angular.element(document.querySelector("#status"))[0].value,a.solicitante=angular.element(document.querySelector("#solicitante"))[0].value,a.prioridade=angular.element(document.querySelector("#prioridade"))[0].value,a.assunto=angular.element(document.querySelector("#assunto"))[0].value,a.categoria=angular.element(document.querySelector("#categoria"))[0].value;var o=angular.element(document.getElementsByName("campo_adicional"));a.responsavel=angular.element(document.querySelector("#responsavel"))[0].value,a.campo_adicional=[],angular.forEach(o,function(t){var e={id:t.attributes["data-campo-id"].value,value:t.value.toUpperCase()};a.campo_adicional.push(e)}),a.assunto=a.assunto.toUpperCase(),a.mensagem=a.mensagem.toUpperCase(),a.id=_ticket_id,t.success=!1,t.errors=!1,e.atualizarTicket(a).then(function(a){t.ticket.mensagem="",t.success=a.data.mensagem,t.url="../"+a.data.id},function(a){t.errors=a.data})},t.cancelar=function(t){location.href="../"+_ticket_id}}])}()},300:function(t,a){!function(){"use strict";angular.module("app").controller("listarProprioTicketCtrl",["$scope","$http","TicketFactory","$cookies","$filter","$location",function(t,a,e,o,i,r){_filtro;var n=_departamentos,c=_usuarios,d=function(){return void 0!==o.get("ticket_proprio_codigo")||void 0!==o.get("ticket_proprio_assunto")||void 0!==o.get("ticket_proprio_ticket_de")||void 0!==o.get("ticket_proprio_ticket_ate")||void 0!==o.get("ticket_proprio_aberto")||void 0!==o.get("ticket_proprio_usuario_responsavel")||void 0!==o.get("ticket_proprio_categoria")||void 0!==o.get("ticket_proprio_statuse")||void 0!==o.get("ticket_proprio_prioridade")};t.defineFiltro=function(){var a=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";a!=t.filter.coluna&&(t.filter.coluna=a),t.filter.ordem="asc"==t.filter.ordem?"desc":"asc",t.pesquisaTicket(t.filter)},t.onGetPage=function(a){a>=1&&a<=t.paginacao.totalDePaginas&&(t.filter.to=a,t.pesquisaTicket(t.filter))},t.pesquisaTicket=function(a){t.disableButton=!0,t.success=!1,t.errors=!1,t.carregando=!0,e.pesquisarTicketProprio(t.filter).then(function(e){t.lista=e.data.ticket.data;var i=1==e.data.ticket.current_page?1:e.data.ticket.total<a.limite?(e.data.ticket.current_page-1)*a.limite+e.data.ticket.total:(e.data.ticket.current_page-1)*a.limite+1,r=0==a.limite?e.data.ticket.total:e.data.ticket.total<a.limite?e.data.ticket.total:e.data.ticket.current_page*a.limite,n=e.data.ticket.total%a.limite==0?e.data.ticket.total/a.limite:Math.floor(e.data.ticket.total/a.limite)+1;o.put("ticket_proprio_assunto",e.data.assunto),o.put("ticket_proprio_codigo",e.data.codigo),o.put("ticket_proprio_departamento",e.data.departamento),o.put("ticket_proprio_aberto",e.data.aberto),o.put("ticket_proprio_usuario_responsavel",e.data.usuario_responsavel),o.put("ticket_proprio_pagina",a.pagina),o.put("ticket_proprio_ticket_de",a.de),o.put("ticket_proprio_ticket_ate",a.ate),t.paginacao={total:e.data.ticket.total,pagina:e.data.ticket.current_page,de:i,ate:r,limite:a.limite,totalDePaginas:n}},function(a){t.errors=a.data,401==a.status&&(t.reload=function(){location.href="/login"},t.reload())}).finally(function(){t.disableButton=!1,t.carregando=!1})},t.abrePesquisa=function(){1==t.filtro?(t.filtro=!1,t.filtrando=!1):(t.filtro=!0,t.filtrando=!0)},t.limpaPesquisa=function(){t.filter.de="",t.filter.ate="",t.filter.aberto="true",t.filter.assunto="",t.filter.codigo="",t.filter.usuario_responsavel=c[0],t.filter.usuario_solicitante=c[0],t.filter.departamento=n[0],t.filter.categoria=0,t.filter.statuse=0,t.filter.prioridade=0,t.pesquisaTicket(t.filter)},t.selecionaDepartamento=function(){0!=t.filter.departamento.id&&(e.getPrioridade(t.filter.departamento.id).then(function(a){t.prioridades=a.data},function(a){t.errors=a.data}).finally(function(){}),e.getStatus(t.filter.departamento.id).then(function(a){t.statuses=a.data},function(a){t.errors=a.data}).finally(function(){}),e.getCategoria(t.filter.departamento.id).then(function(a){t.categorias=a.data},function(a){t.errors=a.data}).finally(function(){})),0==t.filter.departamento.id&&(t.categorias="",t.statuses="",t.prioridades="")},t.verificaCookiesDepartamento=function(){t.filter.departamento=t.departamentos[s("ticket_proprio_departamento",t.departamentos)]},t.verificaCookiesStatuse=function(){},t.verificaCookiesCategoria=function(){},t.verificaCookiesPrioridade=function(){},t.verificaCookiesSolicitante=function(){t.filter.usuario_solicitante=t.usuarios[s("ticket_proprio_usuario_solicitante",t.usuarios)]},t.verificaCookiesResponsavel=function(){t.filter.usuario_responsavel=t.usuarios[s("ticket_proprio_usuario_responsavel",t.usuarios)]};var s=function(t,a){if(isNaN(parseInt(o.get(t)))||"0"==o.get(t))return 0;var e=0;return angular.forEach(a,function(i){i.id==o.get(t)&&(e=a.indexOf(i))}),e};t.csv=function(){document.exportar.action="/ticket/download/csv",document.exportar.submit()},t.xlsx=function(){document.exportar.action="/ticket/download/xlsx",document.exportar.submit()};n.unshift({id:"",nome:""}),t.departamentos=n,c.unshift({id:"",nome:""}),t.usuarios=c,t.filter={coluna:"status_ordem",ordem:"asc",pagina:1,limite:50,reverso:!0,aberto:!0,departamento:0,usuario_responsavel:0,categoria:0,statuse:0,prioridade:0,assunto:"",codigo:""},t.paginacao={de:0,ate:0,total:0,pagina:0},0==d()?(t.filter.de="",t.filter.ate="",t.filter.aberto="true",t.filter.codigo="",t.filter.assunto="",t.filter.departamento=void 0,t.filter.usuario_responsavel=void 0,t.filter.categoria=void 0,t.filter.statuse=void 0,t.filter.prioridade=void 0):(t.filtro=""!=o.get("ticket_proprio_codigo")||""!=o.get("ticket_proprio_assunto")||!isNaN(parseInt(o.get("ticket_proprio_usuario_responsavel")))&&"0"!=o.get("ticket_proprio_usuario_responsavel")||"true"!=o.get("ticket_proprio_aberto")||!isNaN(parseInt(o.get("ticket_proprio_ticket_de")))&&""!=o.get("ticket_proprio_ticket_de")||!isNaN(parseInt(o.get("ticket_proprio_ticket_ate")))&&""!=o.get("ticket_proprio_ticket_ate")||!isNaN(parseInt(o.get("ticket_proprio_usuario_solicitante")))&&"0"!=o.get("ticket_proprio_usuario_solicitante")||!isNaN(parseInt(o.get("ticket_proprio_departamento")))&&"0"!=o.get("ticket_proprio_departamento"),t.filter.de=o.get("ticket_proprio_ticket_de"),t.filter.ate=o.get("ticket_proprio_ticket_ate"),t.filter.codigo=o.get("ticket_proprio_codigo"),t.filter.assunto=o.get("ticket_proprio_assunto"),t.filter.usuario_responsavel=o.get("ticket_proprio_usuario_responsavel"),t.filter.departamento=o.get("ticket_proprio_departamento"),t.filter.aberto=o.get("ticket_proprio_aberto"),t.filter.categoria=o.get("ticket_proprio_categoria"),t.filter.statuse=o.get("ticket_proprio_statuse"),t.filter.prioridade=o.get("ticket_proprio_prioridade")),t.pesquisaTicket(t.filter)}]),angular.module("app").config(["$qProvider",function(t){t.errorOnUnhandledRejections(!1)}])}()},301:function(t,a){!function(){"use strict";angular.module("app").controller("dashboardTicketCtrl",["$scope","$timeout","DashboardFactory","$cookies","$uibModal",function(t,a,e,o,i){var r=_migalhas,n=_departamentos,c=_visualizar_todos,d=_timeout;setInterval(function(){location.reload()},12e5);var s=function t(){l(),setTimeout(function(){t()},1e3*d)},u=function(a){return t.stringData="","customizado"==a.value?(void 0!==o.get("dashboard_ticket_data_de")&&void 0!==o.get("dashboard_ticket_data_ate")?t.stringData=o.get("dashboard_ticket_data_de")+" até "+o.get("dashboard_ticket_data_ate"):t.stringData=t.data.nome,!0):(t.stringData=t.data.nome,!1)},l=function(){if(void 0!==o.get("dashboard_ticket_departamento")&&void 0!==o.get("dashboard_ticket_data")){var e=!0,i={id:o.get("dashboard_ticket_departamento"),data:o.get("dashboard_ticket_data")};u(t.data)&&(void 0!==o.get("dashboard_ticket_data_de")&&void 0!==o.get("dashboard_ticket_data_ate")?(i.data_de=o.get("dashboard_ticket_data_de"),t.data.data_de=o.get("dashboard_ticket_data_de"),i.data_ate=o.get("dashboard_ticket_data_ate"),t.data.data_ate=o.get("dashboard_ticket_data_ate")):e=!1),e&&(t.carregando=!0,t.viewTela=!0,p(i),a(function(){t.carregando=!1},2e3))}},p=function(a){e.getDashboardTicket(a).then(function(a){t.ticketsNovos=a.data.ticketsNovos,t.totalDeTicketsAbertos=a.data.totalDeTicketsAbertos,t.ticketsFechadosNoPeriodo=a.data.ticketsFechadosNoPeriodo,t.avaliacao=a.data.avaliacao,t.avaliacaoQtde=0==a.data.avaliacaoQtde?"":a.data.avaliacaoQtde,0==a.data.avaliacaoQtde?t.avaliacaoQtdeTexto="":1==a.data.avaliacaoQtde?t.avaliacaoQtdeTexto="AVALIAÇÃO":t.avaliacaoQtdeTexto="AVALIAÇÕES",t.tempoMedioDeAtendimento=a.data.tempoMedioDeAtendimento,t.responsaveis=a.data.responsaveis,t.ticketsAbertosPorDepartamento=a.data.ticketsAbertosPorDepartamento,google.charts.load("current",{packages:["corechart","bar"]}),google.charts.setOnLoadCallback(_(a)),google.charts.setOnLoadCallback(function(t){var a=[];t.data.responsaveisFechados.forEach(function(t){a.push(t.cor)});var e=new google.visualization.DataTable;e.addColumn("string","nome"),e.addColumn("number","total"),t.data.responsaveisFechados.forEach(function(t){e.addRow([t.nome,t.total])});var o={pieHole:.5,pieSliceTextStyle:{color:"#333333",bold:!0,fontSize:18},legend:"none",chartArea:{width:"100%",height:"100%"},colors:a,pieSliceText:"value"},i=document.getElementById("idNoDataFechados"),r=document.getElementById("idTicketsPorResponsavelFechados");if(i.style.display="none",r.style.display="none",0==e.getNumberOfRows())i.style.display="block";else{r.style.display="block";var n=new google.visualization.PieChart(document.getElementById("idTicketsPorResponsavelFechados"));n.draw(e,o)}}(a)),google.charts.setOnLoadCallback(function(a){var e=[];a.data.status.forEach(function(t){e.push(t.cor)});var o=new google.visualization.DataTable;o.addColumn("string","nome"),o.addColumn("number","total"),a.data.status.forEach(function(t){o.addRow([t.nome,t.total])});var i={pieHole:.5,pieSliceTextStyle:{color:"#333333",bold:!0,fontSize:18},legend:"none",chartArea:{width:"100%",height:"100%"},colors:e,pieSliceText:"value"},r=document.getElementById("idNoDataStatus"),n=document.getElementById("ticketsPorStatusCtrl");if(r.style.display="none",n.style.display="none",0==o.getNumberOfRows())r.style.display="block";else{var c=0;a.data.status.forEach(function(t){0==t.total&&c++});var d=a.data.status.length;if(c==d)r.style.display="block";else{n.style.display="block",t.status=a.data.status;var s=new google.visualization.PieChart(document.getElementById("ticketsPorStatusCtrl"));s.draw(o,i)}}}(a)),google.charts.setOnLoadCallback(function(a){var e=[];t.prioridades=a.data.prioridades,a.data.prioridades.forEach(function(t){e.push(t.cor)});var o=new google.visualization.DataTable;o.addColumn("string","nome"),o.addColumn("number","total"),a.data.prioridades.forEach(function(t){o.addRow([t.nome,t.total])});var i={pieHole:.5,pieSliceTextStyle:{color:"#333333",bold:!0,fontSize:18},legend:"none",chartArea:{width:"100%",height:"100%"},colors:e,pieSliceText:"value"},r=document.getElementById("idNoDataPrioridades"),n=document.getElementById("ticketsAbertosPorPrioridadeCtrl");if(r.style.display="none",n.style.display="none",0==o.getNumberOfRows())r.style.display="block";else{n.style.display="block";var c=new google.visualization.PieChart(document.getElementById("ticketsAbertosPorPrioridadeCtrl"));c.draw(o,i)}}(a)),google.charts.setOnLoadCallback(function(t){var a=new google.visualization.DataTable;a.addColumn("string","Categoria"),a.addColumn("number","Qtd. de tickets"),a.addColumn({type:"string",role:"annotation"}),t.data.ticketsPorCategoria.forEach(function(t){a.addRow(["",t.total,t.nome+": "+t.total])});new google.visualization.BarChart(document.getElementById("columnchart_values")).draw(a,{chartArea:{width:"90%",height:"90%"},bar:{groupWidth:"30"},legend:{position:"none"},colors:["#0073b7"],annotations:{textStyle:{fontSize:12,bold:!0,color:"#333"}},vAxis:{minValue:0,viewWindow:{min:0},textStyle:{fontSize:12,bold:!0,color:"#444"}},hAxis:{gridlines:{count:0},minValue:0,viewWindow:{min:0}}})}(a))})};t.hoverInDepartamento=function(){t.viewDepartamento=!1},t.hoverOutDepartamento=function(){t.viewDepartamento=!0},t.hoverInData=function(){t.viewData=!1},t.hoverOutData=function(){t.viewData=!0};var f=function(t,a){var e=0,o=!1;return angular.forEach(t,function(t){"selected"==t.selected&&(e=a.indexOf(t),o=!0)}),o?e:-1},m=function(){if(""!=t.departamentos)if(void 0===o.get("dashboard_ticket_departamento")){-1==f(n,t.departamentos)?t.departamento.nome="SELECIONE UM DEPARTAMENTO":(t.departamento=t.departamentos[f(n,t.departamentos)],o.put("dashboard_ticket_departamento",t.departamento.id))}else{var a=0;angular.forEach(t.departamentos,function(e){e.id==o.get("dashboard_ticket_departamento")&&(a=t.departamentos.indexOf(e))}),t.departamento=t.departamentos[a]}},g=function(){if(void 0===o.get("dashboard_ticket_data"))t.data={value:"mes_atual",nome:"MÊS ATUAL"},o.put("dashboard_ticket_data",t.data.value);else{var a=0;angular.forEach(t.datas,function(e){e.value==o.get("dashboard_ticket_data")&&(a=t.datas.indexOf(e))}),t.data=t.datas[a]}u(t.data)};t.setDepartamentoCookie=function(a){o.put("dashboard_ticket_departamento",a.id),t.viewDepartamento=!0,l()},t.setDataCookie=function(a){o.put("dashboard_ticket_data",a.value),t.viewData=!0,"customizado"==a.value?t.modalPeriodo():l(),t.stringData=t.data.nome},t.modalPeriodo=function(){var a=i.open({animation:!0,ariaLabelledBy:"modal-title-bottom",ariaDescribedBy:"modal-body-bottom",size:"md",scope:t,templateUrl:"periodoModal.html",resolve:{},controller:function(t,e){void 0!==o.get("dashboard_ticket_data_de")&&void 0!==o.get("dashboard_ticket_data_ate")?(t.data_de=o.get("dashboard_ticket_data_de"),t.data_ate=o.get("dashboard_ticket_data_ate")):(t.data_de=e("date")(new Date,"dd/MM/yyyy"),t.data_ate=e("date")(new Date,"dd/MM/yyyy")),t.modalFecharCustomizado=function(){t.$parent.stringData=t.data.nome,a.close()},t.modalData=function(){o.put("dashboard_ticket_data_de",t.data_de),o.put("dashboard_ticket_data_ate",t.data_ate),t.$parent.stringData=o.get("dashboard_ticket_data_de")+" até "+o.get("dashboard_ticket_data_ate"),l(),a.close()}}})},t.porResponsavel=function(){document.exportar.action="dashboard/download/responsavel",document.exportar.submit()},t.porStatus=function(){document.exportar.action="dashboard/download/status",document.exportar.submit()},t.porPrioridade=function(){document.exportar.action="dashboard/download/prioridade",document.exportar.submit()},t.porCategoria=function(){document.exportar.action="dashboard/download/categoria",document.exportar.submit()},t.porAvaliacao=function(){document.exportar.action="dashboard/download/avaliacao",document.exportar.submit()};var _=function(t){var a=[];t.data.responsaveisAbertos.forEach(function(t){a.push(t.cor)});var e=new google.visualization.DataTable;e.addColumn("string","nome"),e.addColumn("number","total"),t.data.responsaveisAbertos.forEach(function(t){e.addRow([t.nome,t.total])});var o={pieHole:.5,pieSliceTextStyle:{color:"#333333",bold:!0,fontSize:18},legend:"none",chartArea:{width:"100%",height:"100%"},colors:a,pieSliceText:"value"},i=document.getElementById("idNoDataAbertos"),r=document.getElementById("idTicketsPorResponsavelAbertos");(i.style.display="none",r.style.display="none",0==e.getNumberOfRows())?i.style.display="block":(r.style.display="block",new google.visualization.PieChart(document.getElementById("idTicketsPorResponsavelAbertos")).draw(e,o))};t.grafico="",t.migalhas=r,t.departamentos=n,t.visualizar_todos=c,t.departamento={},t.datas=[{value:"hoje",nome:"HOJE"},{value:"mes_atual",nome:"MÊS ATUAL"},{value:"ultimos_trinta_dias",nome:"ÚLTIMOS 30 DIAS"},{value:"ano_atual",nome:"ANO ATUAL"},{value:"ultimo_ano",nome:"ÚLTIMO ANO"},{value:"customizado",nome:"CUSTOMIZADO"}],t.data={},t.viewDepartamento=!0,t.viewData=!0,t.carregando=!1,t.viewTela=!1,m(),g(),l(),setTimeout(function(){s()},1e3)}])}()},302:function(t,a){!function(){"use strict";angular.module("app").factory("DashboardFactory",["$http",function(t){return{getDashboardTicket:function(a){return t.post("/ticket/dashboard/"+a.id,a)}}}])}()}},[294]);