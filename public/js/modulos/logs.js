webpackJsonp([16],{291:function(t,o,e){e(292),t.exports=e(293)},292:function(t,o){!function(){"use strict";angular.module("app").factory("LogFactory",["$http",function(t){return{pesquisaLog:function(o){return t.post("/log/acessos/search",o)}}}])}()},293:function(t,o){!function(){"use strict";angular.module("app").controller("listarLogsCtrl",["$scope","$http","LogFactory","$cookies","$filter","$location",function(t,o,e,a,i,s){var l=_logs,r=(_filtro,_perfis),n=_tipos,c=function(){return void 0!==a.get("log_acessos_usuario")||void 0!==a.get("log_acessos_ip")||void 0!==a.get("log_acessos_tipo")||void 0!==a.get("log_acessos_perfil")};t.verificaCookiesPerfil=function(){t.filter.perfil=t.perfis[u("log_acessos_perfil",t.perfis)]},t.verificaCookiesTipo=function(){t.filter.tipo=t.tipos[u("log_acessos_tipo",t.tipos)]};var u=function(t,o){if(""==a.get(t))return 0;var e=0;return angular.forEach(o,function(i){i==a.get(t)&&(e=o.indexOf(i))}),e};t.defineFiltro=function(){var o=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";o!=t.filter.coluna&&(t.filter.coluna=o),t.filter.ordem="asc"==t.filter.ordem?"desc":"asc",t.pesquisaLog(t.filter)},t.onGetPage=function(o){o>=1&&o<=t.paginacao.totalDePaginas&&(t.filter.to=o,t.pesquisaLog(t.filter))},t.pesquisaLog=function(o){t.disableButton=!0,t.success=!1,t.errors=!1,t.carregando=!0,e.pesquisaLog(o).then(function(e){t.lista=e.data.logs.data;var i=1==e.data.logs.current_page?1:e.data.logs.total<o.limite?(e.data.logs.current_page-1)*o.limite+e.data.logs.total:(e.data.logs.current_page-1)*o.limite+1,s=0==o.limite?e.data.logs.total:e.data.logs.total<o.limite?e.data.logs.total:e.data.logs.current_page*o.limite,l=e.data.logs.total%o.limite==0?e.data.logs.total/o.limite:Math.floor(e.data.logs.total/o.limite)+1;a.put("log_acessos_de",o.de),a.put("log_acessos_ate",o.ate),a.put("log_acessos_usuario",o.usuario),a.put("log_acessos_ip",o.ip),a.put("log_acessos_tipo",o.tipo),a.put("log_acessos_perfil",o.perfil),t.paginacao={total:e.data.logs.total,pagina:e.data.logs.current_page,de:i,ate:s,limite:o.limite,totalDePaginas:l}},function(o,e){t.errors=o.data}).finally(function(){t.disableButton=!1,t.carregando=!1})},t.limpaPesquisa=function(){t.filter.usuario="",t.filter.ip="",t.filter.perfil=r[0],t.filter.tipo=n[0],t.filter.de=i("date")(new Date,"dd/MM/y"),t.filter.ate=i("date")(new Date,"dd/MM/y"),t.pesquisaLog(t.filter)},t.abrePesquisa=function(){1==t.filtro?(t.filtro=!1,t.filtrando=!1):(t.filtro=!0,t.filtrando=!0)},t.csv=function(){document.exportar.action="/log/acessos/download/csv",document.exportar.submit()},t.xlsx=function(){document.exportar.action="/log/acessos/download/xlsx",document.exportar.submit()},r.unshift(""),n.unshift(""),t.logs=l,t.perfis=r,t.tipos=n,t.filter={coluna:"created_at",ordem:"desc",pagina:1,limite:50},t.paginacao={de:0,ate:0,total:0,pagina:0},0==c()?(t.filter.de=i("date")(new Date,"dd/MM/y"),t.filter.ate=i("date")(new Date,"dd/MM/y"),t.filter.usuario="",t.filter.ip="",t.filter.tipo="",t.filter.perfil=""):(t.filtro=""!=a.get("log_acessos_usuario")||""!=a.get("log_acessos_ip")||""!=a.get("log_acessos_tipo")||""!=a.get("log_acessos_perfil"),t.filter.de=a.get("log_acessos_de"),t.filter.ate=a.get("log_acessos_ate"),t.filter.ip=a.get("log_acessos_ip"),t.filter.usuario=a.get("log_acessos_usuario")),t.pesquisaLog(t.filter)}])}()}},[291]);